<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Emoji Alchemy</title>
    <style>
        :root { --bg: #050505; --accent: #ffcc00; --panel: rgba(20, 20, 20, 0.95); }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        canvas { position: absolute; top: 0; left: 0; pointer-events: none; }
        #header { z-index: 10; padding: 10px 20px; background: var(--panel); border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: space-between; }
        #board { flex-grow: 1; position: relative; z-index: 5; overflow: hidden; touch-action: none; }
        #inventory-container { z-index: 10; height: 30vh; background: var(--panel); border-top: 1px solid #444; display: flex; flex-direction: column; }
        #inventory { display: flex; flex-wrap: wrap; gap: 10px; padding: 15px; overflow-y: auto; justify-content: center; }
        .emoji { font-size: 2.5rem; cursor: grab; display: flex; flex-direction: column; align-items: center; width: 85px; user-select: none; position: relative; }
        .emoji-label { font-size: 0.65rem; color: #888; margin-top: 4px; text-align: center; pointer-events: none; }
        .on-board { position: absolute; z-index: 50; }
        .lvl-badge { position: absolute; top: -5px; right: 5px; font-size: 0.7rem; background: #7000ff; border-radius: 50%; width: 18px; height: 18px; display: flex; align-items: center; justify-content: center; color: white; }
        .money-text { color: #44ff44; font-weight: bold; font-family: monospace; font-size: 1.1rem; }
        #shop-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #151515; border: 2px solid var(--accent); padding: 20px; z-index: 100; border-radius: 15px; text-align: center; min-width: 250px; }
        button { background: #222; border: 1px solid var(--accent); color: var(--accent); padding: 8px 15px; border-radius: 15px; cursor: pointer; font-weight: bold; }
        input { background: #222; border: 1px solid #444; color: white; padding: 8px 15px; border-radius: 20px; width: 80%; margin: 10px auto; display: block; outline: none; }
    </style>
</head>
<body>

<canvas id="star-canvas"></canvas>
<canvas id="yellow-star-canvas"></canvas>

<div id="header">
    <div id="stats-bar">
        <div class="money-text">$<span id="money-display">0</span></div>
        <div style="font-size: 0.7rem; color: #888;">Rebirths: <span id="rebirth-display">0</span> | Found: <span id="found-count">0</span>/206</div>
    </div>
    <div style="display: flex; gap: 10px;">
        <button onclick="toggleShop()">ðŸª™ REBIRTH</button>
        <button onclick="clearBoard()">CLEAR</button>
    </div>
</div>

<div id="board"></div>

<div id="inventory-container">
    <input type="text" id="search" placeholder="Search items..." oninput="filterInventory()">
    <div id="inventory"></div>
</div>

<div id="shop-modal">
    <h3>Rebirth Shop</h3>
    <p>Cost: $100,000</p>
    <button onclick="attemptRebirth()">BUY REBIRTH</button>
    <button onclick="toggleShop()" style="border-color: #ff4444; color: #ff4444; margin-top: 10px;">CLOSE</button>
</div>

<script>
    let money = 0;
    let rebirths = 0;
    const REBIRTH_COST = 100000;

    // Levels added to recipes for income logic
   const recipes = {
    // --- TIER 1-6: ELEMENTAL ORIGINS ---
    "ðŸ”¥+ðŸŒ": { result: "ðŸŒ‹", name: "Volcano", lvl: 2 },
    "ðŸ’§+ðŸ”¥": { result: "ðŸ’¨", name: "Steam", lvl: 2 },
    "ðŸŒ+ðŸ’§": { result: "ðŸ’©", name: "Mud", lvl: 2 },
    "ðŸ’¨+ðŸ”¥": { result: "âš¡", name: "Energy", lvl: 2 },
    "ðŸ’¨+ðŸ’§": { result: "ðŸŒ§ï¸", name: "Rain", lvl: 2 },
    "ðŸŒ§ï¸+ðŸŒ": { result: "ðŸŒ±", name: "Plant", lvl: 2 },
    "ðŸ”¥+ðŸ”¥": { result: "â˜€ï¸", name: "Sun", lvl: 2 },
    "ðŸŒ+ðŸŒ": { result: "ðŸ”ï¸", name: "Mountain", lvl: 2 },
    "ðŸ’¨+ðŸ’¨": { result: "ðŸŒ¬ï¸", name: "Wind", lvl: 2 },
    "ðŸŒ‹+ðŸ’§": { result: "ðŸª¨", name: "Stone", lvl: 3 },
    "ðŸª¨+ðŸ”¥": { result: "â›“ï¸", name: "Metal", lvl: 3 },
    "ðŸª¨+ðŸ’¨": { result: "ðŸ–ï¸", name: "Sand", lvl: 3 },
    "ðŸ–ï¸+ðŸ”¥": { result: "ðŸ”®", name: "Glass", lvl: 3 },
    "ðŸŒ±+â˜€ï¸": { result: "ðŸŒ»", name: "Flower", lvl: 3 },
    "ðŸŒ±+ðŸ’§": { result: "ðŸŒ¿", name: "Herb", lvl: 3 },

    // --- TIER 7-12: INDUSTRIAL AGE ---
    "ðŸŒ±+ðŸŒ": { result: "ðŸŒ³", name: "Tree", lvl: 2 },
    "ðŸŒ³+ðŸ”¥": { result: "ðŸªµ", name: "Wood", lvl: 3 },
    "ðŸª¨+ðŸª¨": { result: "ðŸ§±", name: "Brick", lvl: 3 },
    "ðŸ§±+ðŸ§±": { result: "ðŸ ", name: "House", lvl: 4 },
    "ðŸ +ðŸ ": { result: "ðŸ˜ï¸", name: "Village", lvl: 5 },
    "ðŸ˜ï¸+ðŸ˜ï¸": { result: "ðŸ™ï¸", name: "City", lvl: 6 },
    "â›“ï¸+ðŸªµ": { result: "ðŸ”¨", name: "Hammer", lvl: 4 },
    "âš¡+ðŸ”®": { result: "ðŸ’¡", name: "Lightbulb", lvl: 4 },
    "â›“ï¸+âš¡": { result: "ðŸ”‹", name: "Battery", lvl: 4 },
    "ðŸªµ+ðŸª¨": { result: "ðŸ“", name: "Ruler", lvl: 3 },
    "ðŸŒ±+ðŸŒ§ï¸": { result: "ðŸ“„", name: "Paper", lvl: 3 },
    "ðŸª¨+ðŸ”¨": { result: "âœï¸", name: "Writing", lvl: 5 },
    "â›“ï¸+â›“ï¸": { result: "âš™ï¸", name: "Gear", lvl: 4 },
    "âš™ï¸+âš¡": { result: "ðŸš‚", name: "Engine", lvl: 5 },
    "ðŸš‚+â›“ï¸": { result: "ðŸšœ", name: "Machine", lvl: 6 },

    // --- TIER 13-18: BIOLOGY & LIFE ---
    "âš¡+ðŸ’§": { result: "ðŸ§ª", name: "Life", lvl: 4 },
    "ðŸ§ª+ðŸŒ": { result: "ðŸ›", name: "Bug", lvl: 5 },
    "ðŸ§ª+ðŸ’§": { result: "ðŸŸ", name: "Fish", lvl: 5 },
    "ðŸ›+ðŸŒ±": { result: "ðŸ¦‹", name: "Butterfly", lvl: 6 },
    "ðŸŸ+ðŸŒ": { result: "ðŸ¦Ž", name: "Reptile", lvl: 6 },
    "ðŸ¦Ž+ðŸ”¥": { result: "ðŸ‰", name: "Dragon", lvl: 7 },
    "ðŸ§ª+ðŸ§ ": { result: "ðŸ§¬", name: "DNA", lvl: 6 },
    "ðŸ§¬+ðŸŒ": { result: "ðŸ’", name: "Monkey", lvl: 7 },
    "ðŸ’+ðŸ§ ": { result: "ðŸ‘¨", name: "Human", lvl: 8 },
    "ðŸ‘¨+ðŸ”¨": { result: "ðŸ‘·", name: "Worker", lvl: 9 },
    "ðŸ‘¨+âœï¸": { result: "ðŸ§‘â€ðŸ«", name: "Scholar", lvl: 9 },
    "ðŸ‘¨+ðŸ§ª": { result: "ðŸ§›", name: "Vampire", lvl: 9 },
    "ðŸ‘¨+ðŸ¦´": { result: "ðŸ’€", name: "Skeleton", lvl: 9 },
    "ðŸ’€+ðŸ§ª": { result: "ðŸ§Ÿ", name: "Zombie", lvl: 10 },
    "ðŸ‘¨+ðŸŽ¨": { result: "ðŸ–¼ï¸", name: "Art", lvl: 9 },

    // --- TIER 19-24: COMPUTER AGE ---
    "ðŸ”‹+âš™ï¸": { result: "ðŸ“Ÿ", name: "Transistor", lvl: 5 },
    "ðŸ“Ÿ+ðŸ“Ÿ": { result: "ðŸ’¾", name: "Microchip", lvl: 6 },
    "ðŸ’¾+ðŸ’¡": { result: "ðŸ–¥ï¸", name: "Monitor", lvl: 7 },
    "ðŸ–¥ï¸+âœï¸": { result: "âŒ¨ï¸", name: "Keyboard", lvl: 8 },
    "ðŸ–¥ï¸+âŒ¨ï¸": { result: "ðŸ’»", name: "Computer", lvl: 9 },
    "ðŸ’»+âš¡": { result: "ðŸŒ", name: "Internet", lvl: 10 },
    "ðŸŒ+ðŸ§ ": { result: "ðŸ¤–", name: "AI", lvl: 11 },
    "ðŸ¤–+ðŸ’»": { result: "ðŸ¦¾", name: "Cyborg", lvl: 12 },
    "ðŸ’»+ðŸŽ®": { result: "ðŸ•¹ï¸", name: "Joystick", lvl: 10 },
    "ðŸ•¹ï¸+ðŸ’»": { result: "ðŸŽ®", name: "Video Game", lvl: 11 },
    "ðŸŒ+ðŸ‘¨": { result: "ðŸ“§", name: "Email", lvl: 11 },
    "ðŸŒ+ðŸ–¼ï¸": { result: "ðŸ“¸", name: "Social Media", lvl: 11 },
    "ðŸ’»+â›“ï¸": { result: "â›ï¸", name: "Bitcoin", lvl: 10 },
    "ðŸ¤–+âš™ï¸": { result: "ðŸ­", name: "Automation", lvl: 12 },
    "ðŸ¤–+ðŸ‘¨": { result: "ðŸ¤", name: "Future", lvl: 13 },

    // --- TIER 25-30: SPACE EXPLORATION ---
    "â˜€ï¸+â˜€ï¸": { result: "ðŸŒŸ", name: "Star", lvl: 3 },
    "ðŸŒŸ+ðŸŒŸ": { result: "ðŸŒŒ", name: "Galaxy", lvl: 4 },
    "ðŸŒŸ+ðŸª¨": { result: "ðŸ•³ï¸", name: "Black Hole", lvl: 4 },
    "ðŸ•³ï¸+ðŸŒ": { result: "â³", name: "Time", lvl: 5 },
    "ðŸš‚+ðŸš€": { result: "ðŸš€", name: "Rocket", lvl: 6 },
    "ðŸš€+ðŸŒ": { result: "ðŸ›°ï¸", name: "Satellite", lvl: 7 },
    "ðŸ›°ï¸+ðŸŒ": { result: "ðŸ“¡", name: "Comms", lvl: 8 },
    "ðŸš€+â˜€ï¸": { result: "â˜„ï¸", name: "Comet", lvl: 7 },
    "ðŸš€+âš¡": { result: "ðŸ›¸", name: "UFO", lvl: 8 },
    "ðŸ›¸+â³": { result: "âŒ›", name: "Wormhole", lvl: 9 },
    "âŒ›+ðŸŒŒ": { result: "ðŸŒ—", name: "Parallel Universe", lvl: 10 },
    "â˜€ï¸+ðŸª¨": { result: "ðŸª", name: "Planet", lvl: 4 },
    "ðŸª+ðŸŒŠ": { result: "ðŸ”±", name: "Atlantis", lvl: 5 },
    "ðŸª+ðŸ ": { result: "ðŸŒ‘", name: "Moon Base", lvl: 5 },
    "ðŸš€+ðŸ‘¨": { result: "ðŸ‘¨â€ðŸš€", name: "Astronaut", lvl: 9 },

    // --- TIER 31-36: QUANTUM PHYSICS ---
    "ðŸ”¬+ðŸ§ª": { result: "âš›ï¸", name: "Atom", lvl: 6 },
    "âš›ï¸+âš¡": { result: "ðŸ’¥", name: "Nuclear Power", lvl: 7 },
    "âš›ï¸+âš›ï¸": { result: "ðŸŒ‘", name: "Dark Matter", lvl: 8 },
    "ðŸŒ‘+ðŸ’¡": { result: "ðŸ”¦", name: "Antimatter", lvl: 9 },
    "âŒ›+âš›ï¸": { result: "ðŸ•°ï¸", name: "Quantum Time", lvl: 10 },
    "ðŸ’»+âš›ï¸": { result: "ðŸ§ª", name: "Quantum PC", lvl: 11 },
    "ðŸ§ª+ðŸ§ ": { result: "ðŸ§¬", name: "Telepathy", lvl: 12 },
    "ðŸ§¬+âš¡": { result: "âš¡", name: "Superpower", lvl: 13 },
    "ðŸŒŒ+âš›ï¸": { result: "ðŸŒ€", name: "Singularity", lvl: 14 },
    "ðŸŒ€+ðŸŒ": { result: "ðŸŒ‹", name: "World Ender", lvl: 15 },
    "ðŸ’¥+ðŸš€": { result: "â˜„ï¸", name: "Warp Drive", lvl: 14 },
    "ðŸ›°ï¸+ðŸŒ‘": { result: "ðŸ“¡", name: "Deep Space", lvl: 15 },
    "ðŸ‘¨â€ðŸš€+ðŸ›¸": { result: "ðŸ‘½", name: "Alien Contact", lvl: 15 },
    "ðŸ‘½+ðŸ§ª": { result: "ðŸ§¬", name: "Hybrid", lvl: 16 },
    "ðŸ§¬+ðŸ¤–": { result: "ðŸ§ ", name: "Synthetic Life", lvl: 17 },

    // --- TIER 37-42: MAGIC & MYTH ---
    "ðŸ”®+ðŸ’¨": { result: "ðŸ§™", name: "Wizard", lvl: 7 },
    "ðŸ§™+ðŸ”¥": { result: "ðŸª„", name: "Magic Wand", lvl: 8 },
    "ðŸª„+ðŸ‡": { result: "ðŸŽ©", name: "Magic Trick", lvl: 9 },
    "ðŸ°+ðŸ›¡ï¸": { result: "âš”ï¸", name: "Knight", lvl: 10 },
    "âš”ï¸+ðŸ‰": { result: "ðŸ’Ž", name: "Dragon Hoard", lvl: 11 },
    "âœ¨+ðŸ’": { result: "ðŸ’", name: "One Ring", lvl: 12 },
    "ðŸ§™+ðŸ“–": { result: "ðŸ“œ", name: "Spellbook", lvl: 13 },
    "ðŸ“œ+âš¡": { result: "âš¡", name: "Lightning Bolt", lvl: 14 },
    "ðŸ“œ+ðŸ’§": { result: "ðŸŒŠ", name: "Tsunami", lvl: 14 },
    "ðŸ§š+âœ¨": { result: "ðŸ¦„", name: "Unicorn", lvl: 15 },
    "ðŸ¦„+ðŸŒˆ": { result: "ðŸ­", name: "Candy Land", lvl: 16 },
    "ðŸ§™+ðŸ§ª": { result: "ðŸ§ª", name: "Potion", lvl: 17 },
    "ðŸ§ª+ðŸŒ™": { result: "ðŸº", name: "Werewolf", lvl: 18 },
    "ðŸŒ™+â˜€ï¸": { result: "ðŸŒ—", name: "Eclipse", lvl: 19 },
    "ðŸŒ—+ðŸ”®": { result: "ðŸ§¿", name: "Prophecy", lvl: 20 },

    // --- TIER 43-50: DIVINITY & META ---
    "ðŸŒŒ+ðŸ§ ": { result: "ðŸ”®", name: "Cosmic Mind", lvl: 21 },
    "ðŸ”®+ðŸŒŸ": { result: "âœ¨", name: "Celestial Forge", lvl: 22 },
    "âœ¨+ðŸ”¨": { result: "ðŸ‘‘", name: "God Mode", lvl: 23 },
    "ðŸ‘‘+ðŸ•³ï¸": { result: "ðŸŽ†", name: "Big Bang", lvl: 24 },
    "ðŸŽ†+â³": { result: "â™¾ï¸", name: "Infinity", lvl: 25 },
    "â™¾ï¸+ðŸŒ": { result: "ðŸŽ®", name: "The Simulation", lvl: 26 },
    "ðŸŽ®+ðŸ‘ï¸": { result: "ðŸ›‘", name: "The Glitch", lvl: 27 },
    "ðŸ›‘+ðŸ‘‘": { result: "âœ¨", name: "Ascension", lvl: 28 },
    "ðŸ™ï¸+ðŸª": { result: "ðŸ°", name: "Galactic Empire", lvl: 29 },
    "ðŸ°+â™¾ï¸": { result: "ðŸŒŒ", name: "Transcendence", lvl: 30 },
    "ðŸ§ +âœ¨": { result: "ðŸ‘ï¸", name: "Enlightenment", lvl: 31 },
    "ðŸ‘ï¸+â™¾ï¸": { result: "ðŸ•‰ï¸", name: "Nirvana", lvl: 32 },
    "ðŸ•‰ï¸+ðŸŒˆ": { result: "ðŸŒˆ", name: "Pure Light", lvl: 33 },
    "ðŸŒˆ+ðŸ›‘": { result: "âšª", name: "The End", lvl: 34 },
    "âšª+ðŸ‘¶": { result: "ðŸ”¥", name: "Rebirth", lvl: 1 }
       // --- TIER: NATURE & ANIMALS (20) ---
        "ðŸŒ±+ðŸ’©": { result: "ðŸ„", name: "Mushroom", lvl: 2 },
        "ðŸŒ³+ðŸ’": { result: "ðŸŒ", name: "Banana", lvl: 3 },
        "ðŸ’§+ðŸŸ": { result: "ðŸ¦ˆ", name: "Shark", lvl: 4 },
        "ðŸŒ+ðŸ›": { result: "ðŸ", name: "Snake", lvl: 3 },
        "â˜€ï¸+ðŸ¦‹": { result: "ðŸ", name: "Bee", lvl: 4 },
        "ðŸ+ðŸŒ»": { result: "ðŸ¯", name: "Honey", lvl: 5 },
        "ðŸŒ¸+ðŸŒ¬ï¸": { result: "ðŸ’¨", name: "Pollen", lvl: 2 },
        "ðŸ”ï¸+ðŸ": { result: "ðŸ”ï¸", name: "Yeti", lvl: 6 },
        "ðŸ¦´+ðŸ•": { result: "ðŸ•", name: "Dog", lvl: 4 },
        "ðŸ¥›+ðŸ±": { result: "ðŸ±", name: "Cat", lvl: 4 },
        "ðŸŒ³+ðŸŒ³": { result: "ðŸŒ²", name: "Forest", lvl: 3 },
        "ðŸŒ²+ðŸ”¥": { result: "ðŸ’¨", name: "Smoke", lvl: 2 },
        "ðŸŒ±+ðŸ": { result: "ðŸŒ¸", name: "Flower", lvl: 3 },
        "ðŸŒŠ+ðŸš": { result: "ðŸ¦€", name: "Crab", lvl: 4 },
        "ðŸŸ+ðŸ¦": { result: "ðŸ§", name: "Penguin", lvl: 5 },
        "ðŸŽ+ðŸŒˆ": { result: "ðŸ¦„", name: "Unicorn", lvl: 6 },
        "ðŸ¦+ðŸœï¸": { result: "ðŸ¦", name: "Lion", lvl: 5 },
        "ðŸŒ³+ðŸŽ": { result: "ðŸŽ", name: "Apple", lvl: 3 },
        "ðŸ¥š+ðŸ”¥": { result: "ðŸ¤", name: "Chick", lvl: 3 },
        "ðŸ¤+â³": { result: "ðŸ”", name: "Chicken", lvl: 4 },

        // --- TIER: FOOD & COOKING (20) ---
        "ðŸ”¥+ðŸŒ¾": { result: "Bread", name: "Bread", lvl: 2 },
        "Bread+ðŸ§€": { result: "ðŸ•", name: "Pizza", lvl: 4 },
        "ðŸ„+â„ï¸": { result: "ðŸ¦", name: "Ice Cream", lvl: 3 },
        "ðŸ”¥+ðŸ¥©": { result: "ðŸ”", name: "Burger", lvl: 4 },
        "ðŸ¥”+ðŸ”¥": { result: "ðŸŸ", name: "Fries", lvl: 3 },
        "ðŸŽ+ðŸ¥§": { result: "ðŸ¥§", name: "Pie", lvl: 4 },
        "â˜•+ðŸ§Š": { result: "ðŸ¥¤", name: "Iced Coffee", lvl: 3 },
        "ðŸ‡+â³": { result: "ðŸ·", name: "Wine", lvl: 5 },
        "ðŸŒ¾+ðŸº": { result: "ðŸº", name: "Beer", lvl: 4 },
        "ðŸª+ðŸ¥›": { result: "ðŸª", name: "Cookie", lvl: 3 },
        "ðŸž+ðŸ¥©": { result: "ðŸ¥ª", name: "Sandwich", lvl: 4 },
        "ðŸ…+ðŸ¥£": { result: "ðŸ²", name: "Soup", lvl: 3 },
        "ðŸš+ðŸŸ": { result: "ðŸ£", name: "Sushi", lvl: 5 },
        "ðŸ«+ðŸ¥›": { result: "ðŸ«", name: "Chocolate", lvl: 3 },
        "ðŸ¯+ðŸ‹": { result: "ðŸµ", name: "Tea", lvl: 3 },
        "ðŸŒ½+ðŸ”¥": { result: "ðŸ¿", name: "Popcorn", lvl: 3 },
        "ðŸ¥”+ðŸ”ª": { result: "ðŸ¥£", name: "Mashed Potato", lvl: 3 },
        "ðŸ“+ðŸ¥›": { result: "ðŸ¥¤", name: "Smoothie", lvl: 4 },
        "ðŸ—+ðŸ”¥": { result: "ðŸ—", name: "Fried Chicken", lvl: 4 },
        "ðŸ¥š+ðŸž": { result: "ðŸ³", name: "French Toast", lvl: 4 },

        // --- TIER: ENTERTAINMENT & MUSIC (20) ---
        "ðŸªµ+â›“ï¸": { result: "ðŸŽ¸", name: "Guitar", lvl: 4 },
        "ðŸŽ¸+âš¡": { result: "ðŸ¤˜", name: "Rock", lvl: 5 },
        "ðŸ“„+ðŸ–Šï¸": { result: "ðŸŽ¼", name: "Sheet Music", lvl: 3 },
        "ðŸŽ¼+ðŸ“»": { result: "ðŸŽµ", name: "Melody", lvl: 4 },
        "ðŸŽµ+ðŸ‘¨": { result: "ðŸŽ¤", name: "Singer", lvl: 6 },
        "ðŸŽ¤+ðŸ’»": { result: "ðŸŽ§", name: "Podcast", lvl: 5 },
        "ðŸ“¸+ðŸŽžï¸": { result: "ðŸŽ¬", name: "Movie", lvl: 5 },
        "ðŸŽ¬+ðŸ¿": { result: "ðŸ“½ï¸", name: "Cinema", lvl: 6 },
        "ðŸŽ¨+âš¡": { result: "ðŸ“º", name: "Television", lvl: 5 },
        "ðŸ“º+ðŸŒ": { result: "ðŸŽžï¸", name: "Streaming", lvl: 6 },
        "ðŸ“»+âš¡": { result: "ðŸŽ™ï¸", name: "Radio Station", lvl: 5 },
        "ðŸŽ¹+ðŸŽ¼": { result: "ðŸŽ»", name: "Orchestra", lvl: 7 },
        "ðŸŽ®+ðŸŒ": { result: "ðŸ•¹ï¸", name: "Esports", lvl: 8 },
        "ðŸŽ¬+ðŸ‘¨": { result: "ðŸ¤µ", name: "Actor", lvl: 7 },
        "ðŸŽ­+ðŸ›ï¸": { result: "ðŸŽŸï¸", name: "Theater", lvl: 6 },
        "ðŸ’ƒ+ðŸŽµ": { result: "ðŸ•º", name: "Party", lvl: 5 },
        "ðŸŽ¤+ðŸ”¥": { result: "ðŸ”¥", name: "Rap Battle", lvl: 6 },
        "ðŸŽ¨+ðŸ–Œï¸": { result: "ðŸ–¼ï¸", name: "Masterpiece", lvl: 8 },
        "ðŸ“±+ðŸ“¸": { result: "ðŸ¤³", name: "Influencer", lvl: 7 },
        "ðŸƒ+ðŸŽ©": { result: "ðŸª„", name: "Magic Show", lvl: 6 },

        // --- TIER: MYTHOLOGY & LEGENDS (20) ---
        "ðŸŽ+ðŸª„": { result: "ðŸ¦„", name: "Unicorn", lvl: 6 },
        "ðŸ”¥+ðŸ¦…": { result: "Phoenix", name: "Phoenix", lvl: 8 },
        "ðŸ”±+ðŸŒŠ": { result: "ðŸ§œâ€â™€ï¸", name: "Mermaid", lvl: 7 },
        "ðŸ’€+ðŸ¹": { result: "ðŸ¦´", name: "Skeleton Archer", lvl: 6 },
        "ðŸ”ï¸+âš’ï¸": { result: "ðŸ§”", name: "Dwarf", lvl: 6 },
        "ðŸŒ³+âœ¨": { result: "ðŸ§", name: "Elf", lvl: 6 },
        "ðŸŒ‘+ðŸ§›": { result: "ðŸ¦‡", name: "Bat", lvl: 5 },
        "ðŸº+ðŸŒ•": { result: "Werewolf", name: "Werewolf", lvl: 7 },
        "ðŸ‰+åŸŽå ¡": { result: "ðŸ‘‘", name: "Kingdom", lvl: 9 },
        "âš¡+ðŸ”¨": { result: "Thor", name: "Thor", lvl: 10 },
        "ðŸŒŠ+ðŸ‰": { result: "ðŸ", name: "Kraken", lvl: 8 },
        "ðŸ”¥+ðŸ‰": { result: "ðŸ²", name: "Ancient Dragon", lvl: 11 },
        "ðŸ§™+ðŸ“–": { result: "ðŸ“œ", name: "Ancient Spell", lvl: 9 },
        "ðŸ›ï¸+ðŸ¦": { result: "ðŸ¦", name: "Sphinx", lvl: 8 },
        "ðŸ‘¼+âš”ï¸": { result: "ðŸ¹", name: "Valkyrie", lvl: 10 },
        "ðŸ’€+ðŸ”¥": { result: "ðŸ‘¹", name: "Demon", lvl: 9 },
        "âœ¨+ðŸ’§": { result: "â›²", name: "Fountain of Youth", lvl: 12 },
        "ðŸ§”+âš¡": { result: "âš¡", name: "Zeus", lvl: 15 },
        "ðŸ+ðŸ‘©": { result: "ðŸ", name: "Medusa", lvl: 9 },
        "ðŸ‘‘+ðŸ›ï¸": { result: "ðŸ›ï¸", name: "Olympus", lvl: 20 }
};

    let unlocked = [
        { icon: "ðŸ”¥", name: "Fire", lvl: 1 }, { icon: "ðŸ’§", name: "Water", lvl: 1 },
        { icon: "ðŸŒ", name: "Earth", lvl: 1 }, { icon: "ðŸ’¨", name: "Air", lvl: 1 },
    ];

    // Particles and Animation
    const bgCanvas = document.getElementById('star-canvas');
    const starCanvas = document.getElementById('yellow-star-canvas');
    const bgCtx = bgCanvas.getContext('2d');
    const starCtx = starCanvas.getContext('2d');
    let bgStars = [], fallingStars = [];

    function initParticles() {
        bgCanvas.width = starCanvas.width = window.innerWidth;
        bgCanvas.height = starCanvas.height = window.innerHeight;
        bgStars = Array(100).fill().map(() => ({ x: Math.random()*bgCanvas.width, y: Math.random()*bgCanvas.height, s: Math.random()*2, o: Math.random() }));
        fallingStars = Array(20).fill().map(() => ({ x: Math.random()*starCanvas.width, y: Math.random()*-starCanvas.height, s: Math.random()*3+2, spd: Math.random()*2+1 }));
    }

    function animate() {
        bgCtx.clearRect(0,0,bgCanvas.width, bgCanvas.height);
        starCtx.clearRect(0,0,starCanvas.width, starCanvas.height);
        bgCtx.fillStyle = "white";
        bgStars.forEach(s => { bgCtx.globalAlpha = s.o; bgCtx.beginPath(); bgCtx.arc(s.x, s.y, s.s, 0, 7); bgCtx.fill(); });
        starCtx.fillStyle = "#ffcc00";
        fallingStars.forEach(s => {
            starCtx.beginPath(); starCtx.arc(s.x, s.y, s.s, 0, 7); starCtx.fill();
            s.y += s.spd; if(s.y > starCanvas.height) { s.y = -20; s.x = Math.random()*starCanvas.width; }
        });
        requestAnimationFrame(animate);
    }

    // Money generation logic
    function processIncome() {
        let totalGain = 0;
        document.querySelectorAll('.on-board').forEach(el => {
            const lvl = parseInt(el.dataset.lvl) || 1;
            let gain = 0;
            if (lvl === 2) gain = Math.random() * 19 + 1;
            else if (lvl === 3) gain = Math.random() * 30 + 20;
            else if (lvl === 4) gain = Math.random() * 150 + 50;
            else if (lvl === 5) gain = Math.random() * 300 + 200;
            else if (lvl >= 6) gain = Math.random() * 1000 + 1000;
            totalGain += gain;
        });
        money += totalGain * (1 + rebirths);
        document.getElementById('money-display').innerText = Math.floor(money).toLocaleString();
    }

    function addItemToBoard(icon, name, lvl) {
        const el = document.createElement('div');
        el.className = 'emoji on-board';
        el.dataset.icon = icon;
        el.dataset.lvl = lvl;
        el.innerHTML = `${icon}${lvl > 1 ? `<span class="lvl-badge">${lvl}</span>` : ''}<span class="emoji-label">${name}</span>`;
        el.style.left = "45%"; el.style.top = "40%";
        document.getElementById('board').appendChild(el);
        attachDrag(el);
    }

    function checkCollision(el) {
        const r1 = el.getBoundingClientRect();
        document.querySelectorAll('.on-board').forEach(other => {
            if (other === el) return;
            const r2 = other.getBoundingClientRect();
            if (!(r1.right < r2.left || r1.left > r2.right || r1.bottom < r2.top || r1.top > r2.bottom)) {
                const key1 = el.dataset.icon + "+" + other.dataset.icon;
                const key2 = other.dataset.icon + "+" + el.dataset.icon;
                const match = recipes[key1] || recipes[key2];
                if (match) {
                    addItemToBoard(match.result, match.name, match.lvl || 1);
                    if (!unlocked.find(u => u.icon === match.result)) {
                        unlocked.push({icon: match.result, name: match.name, lvl: match.lvl || 1});
                        updateUI();
                    }
                    el.remove(); other.remove();
                }
            }
        });
    }

    function attachDrag(el) {
        let x = 0, y = 0, startX = 0, startY = 0;
        const onStart = (e) => {
            const touch = e.type === 'touchstart' ? e.touches[0] : e;
            startX = touch.clientX - x; startY = touch.clientY - y;
            document.addEventListener('mousemove', onMove);
            document.addEventListener('mouseup', onEnd);
            document.addEventListener('touchmove', onMove, {passive: false});
            document.addEventListener('touchend', onEnd);
        };
        const onMove = (e) => {
            const touch = e.type === 'touchmove' ? e.touches[0] : e;
            x = touch.clientX - startX; y = touch.clientY - startY;
            el.style.transform = `translate(${x}px, ${y}px)`;
        };
        const onEnd = () => {
            document.removeEventListener('mousemove', onMove);
            document.removeEventListener('mouseup', onEnd);
            document.removeEventListener('touchmove', onMove);
            document.removeEventListener('touchend', onEnd);
            checkCollision(el);
        };
        el.addEventListener('mousedown', onStart);
        el.addEventListener('touchstart', onStart, {passive: false});
    }

    function updateUI() {
        const inv = document.getElementById('inventory');
        inv.innerHTML = '';
        unlocked.forEach(item => {
            const div = document.createElement('div');
            div.className = 'emoji';
            div.innerHTML = `${item.icon}<span class="emoji-label">${item.name}</span>`;
            div.onclick = () => addItemToBoard(item.icon, item.name, item.lvl || 1);
            inv.appendChild(div);
        });
        document.getElementById('found-count').innerText = unlocked.length;
    }

    function attemptRebirth() {
        if (money >= REBIRTH_COST) { money = 0; rebirths++; clearBoard(); toggleShop(); }
        else { alert("Need $100,000!"); }
    }

    function toggleShop() {
        const modal = document.getElementById('shop-modal');
        modal.style.display = modal.style.display === 'block' ? 'none' : 'block';
    }

    function clearBoard() { document.getElementById('board').innerHTML = ''; }
    function filterInventory() {
        const val = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('#inventory .emoji').forEach(e => {
            e.style.display = e.innerText.toLowerCase().includes(val) ? 'flex' : 'none';
        });
    }

    window.addEventListener('resize', initParticles);
    initParticles(); animate(); updateUI(); setInterval(processIncome, 1000);
</script>
</body>
</html>
