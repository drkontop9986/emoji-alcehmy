<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Emoji Alchemy: Mega Edition</title>
    <style>
        :root { --bg: #050505; --accent: #00f2ff; --panel: rgba(20, 20, 20, 0.95); }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; margin: 0; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        #star-canvas { position: absolute; top: 0; left: 0; pointer-events: none; z-index: 0; }
        #header { z-index: 10; padding: 10px 20px; background: var(--panel); border-bottom: 1px solid #333; display: flex; align-items: center; justify-content: space-between; }
        #board { flex-grow: 1; position: relative; z-index: 5; overflow: hidden; touch-action: none; }
        #inventory-container { z-index: 10; height: 35vh; background: var(--panel); border-top: 1px solid #444; display: flex; flex-direction: column; }
        #inventory { display: flex; flex-wrap: wrap; gap: 10px; padding: 15px; overflow-y: auto; justify-content: center; }
        .emoji { font-size: 2.5rem; cursor: grab; display: flex; flex-direction: column; align-items: center; width: 70px; user-select: none; }
        .emoji-label { font-size: 0.6rem; color: #888; margin-top: 4px; text-align: center; pointer-events: none; }
        .on-board { position: absolute; z-index: 50; transition: transform 0.05s linear; }
        #progress-bar { flex-grow: 1; height: 6px; background: #222; margin: 0 20px; border-radius: 3px; overflow: hidden; position: relative; }
        #progress-bar-inner { height: 100%; background: var(--accent); width: 0%; transition: width 0.4s; box-shadow: 0 0 10px var(--accent); }
        button { background: none; border: 1px solid var(--accent); color: var(--accent); padding: 5px 15px; border-radius: 15px; cursor: pointer; font-size: 0.8rem; }
        input { background: #222; border: 1px solid #444; color: white; padding: 8px 15px; border-radius: 20px; width: 60%; margin: 10px auto; display: block; outline: none; }
    </style>
</head>
<body>

<canvas id="star-canvas"></canvas>

<div id="header">
    <div style="min-width: 120px;">
        <div style="font-size: 0.9rem; font-weight: bold; letter-spacing: 2px;">ALCHEMY</div>
        <div id="stats" style="font-size: 0.7rem; color: #888;">
            <span id="found-count">0</span> / <span id="total-count">126</span>
        </div>
    </div>
    <div id="progress-bar"><div id="progress-bar-inner"></div></div>
    <button onclick="clearBoard()">CLEAR</button>
</div>

<div id="board"></div>

<div id="inventory-container">
    <input type="text" id="search" placeholder="Search items..." oninput="filterInventory()">
    <div id="inventory"></div>
</div>

<script>
 const recipes = {
        // --- TIER 1-6: ELEMENTAL ORIGINS (15) ---
        "ðŸ”¥+ðŸŒ": { result: "ðŸŒ‹", name: "Volcano" },
        "ðŸ’§+ðŸ”¥": { result: "ðŸ’¨", name: "Steam" },
        "ðŸŒ+ðŸ’§": { result: "ðŸ’©", name: "Mud" },
        "ðŸ’¨+ðŸ”¥": { result: "âš¡", name: "Energy" },
        "ðŸ’¨+ðŸ’§": { result: "ðŸŒ§ï¸", name: "Rain" },
        "ðŸŒ§ï¸+ðŸŒ": { result: "ðŸŒ±", name: "Plant" },
        "ðŸ”¥+ðŸ”¥": { result: "â˜€ï¸", name: "Sun" },
        "ðŸŒ+ðŸŒ": { result: "ðŸ”ï¸", name: "Mountain" },
        "ðŸ’¨+ðŸ’¨": { result: "ðŸŒ¬ï¸", name: "Wind" },
        "ðŸŒ‹+ðŸ’§": { result: "ðŸª¨", name: "Stone" },
        "ðŸª¨+ðŸ”¥": { result: "â›“ï¸", name: "Metal" },
        "ðŸª¨+ðŸ’¨": { result: "ðŸ–ï¸", name: "Sand" },
        "ðŸ–ï¸+ðŸ”¥": { result: "ðŸ”®", name: "Glass" },
        "ðŸŒ±+â˜€ï¸": { result: "ðŸŒ»", name: "Flower" },
        "ðŸŒ±+ðŸ’§": { result: "ðŸŒ¿", name: "Herb" },

        // --- TIER 7-12: INDUSTRIAL AGE (15) ---
        "ðŸŒ±+ðŸŒ": { result: "ðŸŒ³", name: "Tree" },
        "ðŸŒ³+ðŸ”¥": { result: "ðŸªµ", name: "Wood" },
        "ðŸª¨+ðŸª¨": { result: "ðŸ§±", name: "Brick" },
        "ðŸ§±+ðŸ§±": { result: "ðŸ ", name: "House" },
        "ðŸ +ðŸ ": { result: "ðŸ˜ï¸", name: "Village" },
        "ðŸ˜ï¸+ðŸ˜ï¸": { result: "ðŸ™ï¸", name: "City" },
        "â›“ï¸+ðŸªµ": { result: "ðŸ”¨", name: "Hammer" },
        "âš¡+ðŸ”®": { result: "ðŸ’¡", name: "Lightbulb" },
        "â›“ï¸+âš¡": { result: "ðŸ”‹", name: "Battery" },
        "ðŸªµ+ðŸª¨": { result: "ðŸ“", name: "Ruler" },
        "ðŸŒ±+ðŸŒ§ï¸": { result: "ðŸ“„", name: "Paper" },
        "ðŸª¨+ðŸ”¨": { result: "âœï¸", name: "Writing" },
        "â›“ï¸+â›“ï¸": { result: "âš™ï¸", name: "Gear" },
        "âš™ï¸+âš¡": { result: "ðŸš‚", name: "Engine" },
        "ðŸš‚+â›“ï¸": { result: "ðŸšœ", name: "Machine" },

        // --- TIER 13-18: BIOLOGY & LIFE (15) ---
        "âš¡+ðŸ’§": { result: "ðŸ§ª", name: "Life" },
        "ðŸ§ª+ðŸŒ": { result: "ðŸ›", name: "Bug" },
        "ðŸ§ª+ðŸ’§": { result: "ðŸŸ", name: "Fish" },
        "ðŸ›+ðŸŒ±": { result: "ðŸ¦‹", name: "Butterfly" },
        "ðŸŸ+ðŸŒ": { result: "ðŸ¦Ž", name: "Reptile" },
        "ðŸ¦Ž+ðŸ”¥": { result: "ðŸ‰", name: "Dragon" },
        "ðŸ§ª+ðŸ§ ": { result: "ðŸ§¬", name: "DNA" },
        "ðŸ§¬+ðŸŒ": { result: "ðŸ’", name: "Monkey" },
        "ðŸ’+ðŸ§ ": { result: "ðŸ‘¨", name: "Human" },
        "ðŸ‘¨+ðŸ”¨": { result: "ðŸ‘·", name: "Worker" },
        "ðŸ‘¨+âœï¸": { result: "ðŸ§‘â€ðŸ«", name: "Scholar" },
        "ðŸ‘¨+ðŸ§ª": { result: "ðŸ§›", name: "Vampire" },
        "ðŸ‘¨+ðŸ¦´": { result: "ðŸ’€", name: "Skeleton" },
        "ðŸ’€+ðŸ§ª": { result: "ðŸ§Ÿ", name: "Zombie" },
        "ðŸ‘¨+ðŸŽ¨": { result: "ðŸ–¼ï¸", name: "Art" },

        // --- TIER 19-24: COMPUTER AGE (15) ---
        "ðŸ”‹+âš™ï¸": { result: "ðŸ“Ÿ", name: "Transistor" },
        "ðŸ“Ÿ+ðŸ“Ÿ": { result: "ðŸ’¾", name: "Microchip" },
        "ðŸ’¾+ðŸ’¡": { result: "ðŸ–¥ï¸", name: "Monitor" },
        "ðŸ–¥ï¸+âœï¸": { result: "âŒ¨ï¸", name: "Keyboard" },
        "ðŸ–¥ï¸+âŒ¨ï¸": { result: "ðŸ’»", name: "Computer" },
        "ðŸ’»+âš¡": { result: "ðŸŒ", name: "Internet" },
        "ðŸŒ+ðŸ§ ": { result: "ðŸ¤–", name: "AI" },
        "ðŸ¤–+ðŸ’»": { result: "ðŸ¦¾", name: "Cyborg" },
        "ðŸ’»+ðŸŽ®": { result: "ðŸ•¹ï¸", name: "Joystick" },
        "ðŸ•¹ï¸+ðŸ’»": { result: "ðŸŽ®", name: "Video Game" },
        "ðŸŒ+ðŸ‘¨": { result: "ðŸ“§", name: "Email" },
        "ðŸŒ+ðŸ–¼ï¸": { result: "ðŸ“¸", name: "Social Media" },
        "ðŸ’»+â›“ï¸": { result: "â›ï¸", name: "Bitcoin" },
        "ðŸ¤–+âš™ï¸": { result: "ðŸ­", name: "Automation" },
        "ðŸ¤–+ðŸ‘¨": { result: "ðŸ¤", name: "Future" },

        // --- TIER 25-30: SPACE EXPLORATION (15) ---
        "â˜€ï¸+â˜€ï¸": { result: "ðŸŒŸ", name: "Star" },
        "ðŸŒŸ+ðŸŒŸ": { result: "ðŸŒŒ", name: "Galaxy" },
        "ðŸŒŸ+ðŸª¨": { result: "ðŸ•³ï¸", name: "Black Hole" },
        "ðŸ•³ï¸+ðŸŒ": { result: "â³", name: "Time" },
        "ðŸš‚+ðŸš€": { result: "ðŸš€", name: "Rocket" },
        "ðŸš€+ðŸŒ": { result: "ðŸ›°ï¸", name: "Satellite" },
        "ðŸ›°ï¸+ðŸŒ": { result: "ðŸ“¡", name: "Comms" },
        "ðŸš€+â˜€ï¸": { result: "â˜„ï¸", name: "Comet" },
        "ðŸš€+âš¡": { result: "ðŸ›¸", name: "UFO" },
        "ðŸ›¸+â³": { result: "âŒ›", name: "Wormhole" },
        "âŒ›+ðŸŒŒ": { result: "ðŸŒ—", name: "Parallel Universe" },
        "â˜€ï¸+ðŸª¨": { result: "ðŸª", name: "Planet" },
        "ðŸª+ðŸŒŠ": { result: "ðŸ”±", name: "Atlantis" },
        "ðŸª+ðŸ ": { result: "ðŸŒ‘", name: "Moon Base" },
        "ðŸš€+ðŸ‘¨": { result: "ðŸ‘¨â€ðŸš€", name: "Astronaut" },

        // --- TIER 31-36: QUANTUM PHYSICS (15) ---
        "ðŸ”¬+ðŸ§ª": { result: "âš›ï¸", name: "Atom" },
        "âš›ï¸+âš¡": { result: "ðŸ’¥", name: "Nuclear Power" },
        "âš›ï¸+âš›ï¸": { result: "ðŸŒ‘", name: "Dark Matter" },
        "ðŸŒ‘+ðŸ’¡": { result: "ðŸ”¦", name: "Antimatter" },
        "âŒ›+âš›ï¸": { result: "ðŸ•°ï¸", name: "Quantum Time" },
        "ðŸ’»+âš›ï¸": { result: "ðŸ§ª", name: "Quantum PC" },
        "ðŸ§ª+ðŸ§ ": { result: "ðŸ§¬", name: "Telepathy" },
        "ðŸ§¬+âš¡": { result: "âš¡", name: "Superpower" },
        "ðŸŒŒ+âš›ï¸": { result: "ðŸŒ€", name: "Singularity" },
        "ðŸŒ€+ðŸŒ": { result: "ðŸŒ‹", name: "World Ender" },
        "ðŸ’¥+ðŸš€": { result: "â˜„ï¸", name: "Warp Drive" },
        "ðŸ›°ï¸+ðŸŒ‘": { result: "ðŸ“¡", name: "Deep Space" },
        "ðŸ‘¨â€ðŸš€+ðŸ›¸": { result: "ðŸ‘½", name: "Alien Contact" },
        "ðŸ‘½+ðŸ§ª": { result: "ðŸ§¬", name: "Hybrid" },
        "ðŸ§¬+ðŸ¤–": { result: "ðŸ§ ", name: "Synthetic Life" },

        // --- TIER 37-42: MAGIC & MYTH (15) ---
        "ðŸ”®+ðŸ’¨": { result: "ðŸ§™", name: "Wizard" },
        "ðŸ§™+ðŸ”¥": { result: "ðŸª„", name: "Magic Wand" },
        "ðŸª„+ðŸ‡": { result: "ðŸŽ©", name: "Magic Trick" },
        "ðŸ°+ðŸ›¡ï¸": { result: "âš”ï¸", name: "Knight" },
        "âš”ï¸+ðŸ‰": { result: "ðŸ’Ž", name: "Dragon Hoard" },
        "âœ¨+ðŸ’": { result: "ðŸ’", name: "One Ring" },
        "ðŸ§™+ðŸ“–": { result: "ðŸ“œ", name: "Spellbook" },
        "ðŸ“œ+âš¡": { result: "âš¡", name: "Lightning Bolt" },
        "ðŸ“œ+ðŸ’§": { result: "ðŸŒŠ", name: "Tsunami" },
        "ðŸ§š+âœ¨": { result: "ðŸ¦„", name: "Unicorn" },
        "ðŸ¦„+ðŸŒˆ": { result: "ðŸ­", name: "Candy Land" },
        "ðŸ§™+ðŸ§ª": { result: "ðŸ§ª", name: "Potion" },
        "ðŸ§ª+ðŸŒ™": { result: "ðŸº", name: "Werewolf" },
        "ðŸŒ™+â˜€ï¸": { result: "ðŸŒ—", name: "Eclipse" },
        "ðŸŒ—+ðŸ”®": { result: "ðŸ§¿", name: "Prophecy" },

        // --- TIER 43-50: DIVINITY & META (15) ---
        "ðŸŒŒ+ðŸ§ ": { result: "ðŸ”®", name: "Cosmic Mind" },
        "ðŸ”®+ðŸŒŸ": { result: "âœ¨", name: "Celestial Forge" },
        "âœ¨+ðŸ”¨": { result: "ðŸ‘‘", name: "God Mode" },
        "ðŸ‘‘+ðŸ•³ï¸": { result: "ðŸŽ†", name: "Big Bang" },
        "ðŸŽ†+â³": { result: "â™¾ï¸", name: "Infinity" },
        "â™¾ï¸+ðŸŒ": { result: "ðŸŽ®", name: "The Simulation" },
        "ðŸŽ®+ðŸ‘ï¸": { result: "ðŸ›‘", name: "The Glitch" },
        "ðŸ›‘+ðŸ‘‘": { result: "âœ¨", name: "Ascension" },
        "ðŸ™ï¸+ðŸª": { result: "ðŸ°", name: "Galactic Empire" },
        "ðŸ°+â™¾ï¸": { result: "ðŸŒŒ", name: "Transcendence" },
        "ðŸ§ +âœ¨": { result: "ðŸ‘ï¸", name: "Enlightenment" },
        "ðŸ‘ï¸+â™¾ï¸": { result: "ðŸ•‰ï¸", name: "Nirvana" },
        "ðŸ•‰ï¸+ðŸŒˆ": { result: "ðŸŒˆ", name: "Pure Light" },
        "ðŸŒˆ+ðŸ›‘": { result: "âšª", name: "The End" },
        "âšª+ðŸ‘¶": { result: "ðŸ”¥", name: "Rebirth" }
    };

    let unlocked = [
        { icon: "ðŸ”¥", name: "Fire" },
        { icon: "ðŸ’§", name: "Water" },
        { icon: "ðŸŒ", name: "Earth" },
        { icon: "ðŸ’¨", name: "Air" },
        { icon: "ðŸ§ ", name: "Brain" },
        { icon: "ðŸ”¨", name: "Hammer" }
    ];

    const canvas = document.getElementById('star-canvas');
    const ctx = canvas.getContext('2d');
    const board = document.getElementById('board');
    const inventory = document.getElementById('inventory');

    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.onresize = resize; resize();

    let stars = Array(100).fill().map(() => ({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, s: Math.random()*2+1, o: Math.random() }));
    function animate() {
        ctx.clearRect(0,0,canvas.width, canvas.height);
        stars.forEach(s => {
            ctx.fillStyle = `rgba(255,255,255,${s.o})`;
            ctx.beginPath(); ctx.arc(s.x, s.y, s.s, 0, 7); ctx.fill();
            s.y += s.s * 0.5; if(s.y > canvas.height) s.y = -10;
        });
        requestAnimationFrame(animate);
    }
    animate();

   function updateUI() {
    inventory.innerHTML = '';
    unlocked.sort((a,b) => a.name.localeCompare(b.name)).forEach(item => {
        const div = document.createElement('div');
            div.className = 'emoji';
            div.innerHTML = `${item.icon}<span class="emoji-label">${item.name}</span>`;
            div.onclick = () => addItemToBoard(item.icon, item.name);
            inventory.appendChild(div);
    });
    
    // --- CHANGE THESE THREE LINES ---
    const totalPossible = 126; 
    document.getElementById('found-count').innerText = unlocked.length;
    document.getElementById('total-count').innerText = totalPossible;
    document.getElementById('progress-bar-inner').style.width = (unlocked.length / totalPossible * 100) + "%";
    
    localStorage.setItem('alchemy_save', JSON.stringify(unlocked));
}

    function addItemToBoard(icon, name) {
        const el = document.createElement('div');
        el.className = 'emoji on-board';
        el.dataset.icon = icon;
        el.innerHTML = `${icon}<span class="emoji-label">${name}</span>`;
        el.style.left = "40%"; el.style.top = "30%";
        board.appendChild(el);
        attachDrag(el);
    }

    function attachDrag(el) {
        let x = 0, y = 0, startX = 0, startY = 0;
        const onStart = (e) => {
            const touch = e.type === 'touchstart' ? e.touches[0] : e;
            startX = touch.clientX - x;
            startY = touch.clientY - y;
            document.addEventListener(e.type === 'touchstart' ? 'touchmove' : 'mousemove', onMove, {passive: false});
            document.addEventListener(e.type === 'touchstart' ? 'touchend' : 'mouseup', onEnd);
        };
        const onMove = (e) => {
            e.preventDefault();
            const touch = e.type === 'touchmove' ? e.touches[0] : e;
            x = touch.clientX - startX;
            y = touch.clientY - startY;
            el.style.transform = `translate(${x}px, ${y}px)`;
        };
        const onEnd = () => {
            document.removeEventListener('mousemove', onMove);
            document.removeEventListener('touchmove', onMove);
            checkCollision(el);
        };
        el.addEventListener('mousedown', onStart);
        el.addEventListener('touchstart', onStart, {passive: false});
    }

    function checkCollision(el) {
        const r1 = el.getBoundingClientRect();
        document.querySelectorAll('.on-board').forEach(other => {
            if (other === el) return;
            const r2 = other.getBoundingClientRect();
            if (!(r1.right < r2.left || r1.left > r2.right || r1.bottom < r2.top || r1.top > r2.bottom)) {
                const key1 = el.dataset.icon + "+" + other.dataset.icon;
                const key2 = other.dataset.icon + "+" + el.dataset.icon;
                const match = recipes[key1] || recipes[key2];
                if (match) {
                    addItemToBoard(match.result, match.name);
                    if (!unlocked.find(u => u.icon === match.result)) {
                        unlocked.push({icon: match.result, name: match.name});
                        updateUI();
                    }
                    el.remove(); other.remove();
                }
            }
        });
    }

    function clearBoard() { board.innerHTML = ''; }
    function filterInventory() {
        const val = document.getElementById('search').value.toLowerCase();
        document.querySelectorAll('#inventory .emoji').forEach(e => {
            e.style.display = e.innerText.toLowerCase().includes(val) ? 'flex' : 'none';
        });
    }

    const saved = localStorage.getItem('alchemy_save');
    if(saved) unlocked = JSON.parse(saved);
    updateUI();
</script>

</body>
</html>
